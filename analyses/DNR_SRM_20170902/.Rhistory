getwd()
#### SET WORKING DIRECTORY ####
setwd("../..") #Set working directory to the master SRM folder
getwd()
#Salinity
salinityData <- read.csv("2017-11-15-Environmental-Data-and-Biomarker-Analyses/2017-12-13-Environmental-Data-Quality-Control/2017-12-18-Salinity-Data-QC-with-Tide-Data.csv", header = TRUE, na.strings = "NA") #Import salinity data
head(salinityData) #Confirm import
colnames(salinityData) #Get column names
salinityData <- salinityData[, -c(1, 10:14)] #Save salinity data as a new dataframe
colnames(salinityData) <- c("DateTime", "Date", "Time", "CIB", "FBB", "PGE", "SKB", "WBB") #Rename columns
salinityData$Date <- as.Date(salinityData$Date) #Recognize Date column as dates
salinityData <- salinityData[salinityData$Date >= "2016-06-19", ] #The outplant only started 6/19. I need to remove all data points before this time.
head(salinityData) #Confirm changes. Note that there are less rows for the salinity data than the other three metrics.
#Salinity
salinityVariablesofInterest <- data.frame("blank1" = rep(0, times = 12),
"blank2" = rep(0, times = 12),
"blank3" = rep(0, times = 12),
"CI" = rep(0, times = 12),
"FB" = rep(0, times = 12),
"PG" = rep(0, times = 12),
"SK" = rep(0, times = 12),
"WB" = rep(0, times = 12)) #Create an empty dataframe. Columns 4-8 are for sites, following the pattern of all environmental variable datasets.
rownames(salinityVariablesofInterest) <- c("Maximum", "Minimum", "Range", "Mean", "Variance", "StandardDeviation", "Percent±2SD", "FirstQuartile", "Median", "ThirdQuartile", "IQR", "Percent±1.5IQR")
head(salinityVariablesofInterest) #Confirm dataframe creation
nSites <- 8 #Sites are in columns 4-8
for(i in 4:nSites) { #For each site
salinityVariablesofInterest[1, i] <- max(salinityData[, i], na.rm = TRUE) #Calculate maximum
salinityVariablesofInterest[2, i] <- min(salinityData[, i], na.rm = TRUE) #Calculate minimum
salinityVariablesofInterest[3, i] <- ((max(salinityData[, i], na.rm = TRUE)) - (min(salinityData[, i], na.rm = TRUE))) #Calculate range
salinityVariablesofInterest[4, i] <- mean(salinityData[, i], na.rm = TRUE) #Calculate mean
salinityVariablesofInterest[5, i] <- var(salinityData[, i], na.rm = TRUE) #Calculate variance
salinityVariablesofInterest[6, i] <- sqrt(var(salinityData[, i], na.rm = TRUE)) #Calculate SD
salinityVariablesofInterest[7, i] <- ((sum((salinityData[, i] > (mean(salinityData[, i], na.rm = TRUE) + (2*sqrt(var(salinityData[, i], na.rm = TRUE))))), (salinityData[, i] < (mean(salinityData[, i], na.rm = TRUE) - (2*sqrt(var(salinityData[, i], na.rm = TRUE))))), na.rm = TRUE))/(length(salinityData[, i])))*100 #Calculate percentage of data more than 2 SDs away from mean
salinityVariablesofInterest[8, i] <- as.numeric(quantile(salinityData[, i], na.rm = TRUE)[2]) #Calculate first quartile
salinityVariablesofInterest[8, i] <- as.numeric(quantile(salinityData[, i], na.rm = TRUE)[3]) #Calculate median
salinityVariablesofInterest[10, i] <- as.numeric(quantile(salinityData[, i], na.rm = TRUE)[4]) #Calculate third quartile
salinityVariablesofInterest[11, i] <- as.numeric(quantile(salinityData[, i], na.rm = TRUE)[4]) - as.numeric(quantile(salinityData[, i], na.rm = TRUE)[2]) #Calculate IQR
salinityVariablesofInterest[12, i] <- ((sum((salinityData[, i] > as.numeric(quantile(salinityData[, i], na.rm = TRUE)[4]) + 1.5*(as.numeric(quantile(salinityData[, i], na.rm = TRUE)[4]) - as.numeric(quantile(salinityData[, i], na.rm = TRUE)[2]))), (salinityData[, i] < as.numeric(quantile(salinityData[, i], na.rm = TRUE)[2]) - 1.5*(as.numeric(quantile(salinityData[, i], na.rm = TRUE)[4]) - as.numeric(quantile(salinityData[, i], na.rm = TRUE)[2]))), na.rm = TRUE))/(length(salinityData[, i])))*100 #Calculate percentage of data more than 1.5*IQR away from the upper or lower quartiles
} #Calculate variables of interest at each site for salinity data
head(salinityVariablesofInterest) #Confirm data table is properly filled
salinityVariablesofInterest <- salinityVariablesofInterest[, -c(1:3)] #Remove blank columns
head(salinityVariablesofInterest) #Confirm changes
#Salinity
write.csv(salinityVariablesofInterest, "2017-11-15-Environmental-Data-and-Biomarker-Analyses/2017-12-13-Environmental-Data-Quality-Control/2017-12-19-Salinity-Data-Variables-of-Interest.csv")
