pHBoxplotCIE <- data.frame(Date.Time = pHData$DateTime,
Site = rep(x = "CI", times = length(pHData$DateTime)),
Habitat = rep(x = "Eelgrass", times = length(pHData$DateTime)),
pH = pHData$CIE) #Create a dataframe for CIE data
pHBoxplotCIE <- pHBoxplotCIE[-c(7489:7490),] #Remove last two rows
pHBoxplotFBB <- data.frame(Date.Time = pHData$DateTime,
Site = rep(x = "FB", times = length(pHData$DateTime)),
Habitat = rep(x = "Bare", times = length(pHData$DateTime)),
pH = pHData$FBB) #Create a dataframe for FBB data
pHBoxplotFBB <- pHBoxplotFBB[-c(7489:7490),] #Remove last two rows
pHBoxplotFBE <- data.frame(Date.Time = pHData$DateTime,
Site = rep(x = "FB", times = length(pHData$DateTime)),
Habitat = rep(x = "Eelgrass", times = length(pHData$DateTime)),
pH = pHData$FBE) #Create a dataframe for FBE data
pHBoxplotFBE <- pHBoxplotFBE[-c(7489:7490),] #Remove last two rows
pHBoxplotPGB <- data.frame(Date.Time = pHData$DateTime,
Site = rep(x = "PG", times = length(pHData$DateTime)),
Habitat = rep(x = "Bare", times = length(pHData$DateTime)),
pH = pHData$PGB) #Create a dataframe for PGB data
pHBoxplotPGB <- pHBoxplotPGB[-c(7489:7490),] #Remove last two rows
pHBoxplotSKB <- data.frame(Date.Time = pHData$DateTime,
Site = rep(x = "SK", times = length(pHData$DateTime)),
Habitat = rep(x = "Bare", times = length(pHData$DateTime)),
pH = pHData$SKB) #Create a dataframe for SKB data
pHBoxplotSKB <- pHBoxplotSKB[-c(7489:7490),] #Remove last two rows
pHBoxplotSKE <- data.frame(Date.Time = pHData$DateTime,
Site = rep(x = "SK", times = length(pHData$DateTime)),
Habitat = rep(x = "Eelgrass", times = length(pHData$DateTime)),
pH = pHData$SKE) #Create a dataframe for SKE data
pHBoxplotSKE <- pHBoxplotSKE[-c(7489:7490),] #Remove last two rows
pHBoxplotWBB <- data.frame(Date.Time = pHData$DateTime,
Site = rep(x = "WB", times = length(pHData$DateTime)),
Habitat = rep(x = "Bare", times = length(pHData$DateTime)),
pH = pHData$WBB) #Create a dataframe for WBB data
pHBoxplotWBB <- pHBoxplotWBB[-c(7489:7490),] #Remove last two rows
pHBoxplotWBE <- data.frame(Date.Time = pHData$DateTime,
Site = rep(x = "WB", times = length(pHData$DateTime)),
Habitat = rep(x = "Eelgrass", times = length(pHData$DateTime)),
pH = pHData$WBE) #Create a dataframe for WBE data
pHBoxplotWBE <- pHBoxplotWBE[-c(7489:7490),] #Remove last two rows
pHBoxplot <- rbind(pHBoxplotCIB, pHBoxplotCIE, pHBoxplotFBB, pHBoxplotFBE, pHBoxplotPGB, pHBoxplotSKB, pHBoxplotSKE, pHBoxplotWBB, pHBoxplotWBE)
boxplot(pHBoxplot$pH ~ pHBoxplot$Site, ylim = pHRange, main = "pH at Sites", cex.main = 3, cex.axis = 1.5) #Make boxplot based on sites and habitat
siteANOVA <- aov(pHBoxplot$pH ~ pHBoxplot$Site) #Perform an ANOVA to test for significant differences in pHs between sites
legend("topright", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
title(xlab = "Site", cex.lab = 2.5, line = 3.5) #Add x-axis label
title(ylab = "pH", cex.lab = 2.5, line = 2.2) #Add y-axis label
boxplot(pHBoxplot$pH ~ pHBoxplot$Site, ylim = pHRange, main = "pH at Sites", cex.main = 3, cex.axis = 1.5) #Make boxplot based on sites and habitat
siteANOVA <- aov(pHBoxplot$pH ~ pHBoxplot$Site) #Perform an ANOVA to test for significant differences in pHs between sites
legend("topright", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
title(xlab = "Site", cex.lab = 2.5, line = 3.5) #Add x-axis label
title(ylab = "pH", cex.lab = 2.5, line = 2.3) #Add y-axis label
boxplot(pHBoxplot$pH ~ pHBoxplot$Site, ylim = pHRange, main = "pH at Sites", cex.main = 3, cex.axis = 1.5) #Make boxplot based on sites and habitat
siteANOVA <- aov(pHBoxplot$pH ~ pHBoxplot$Site) #Perform an ANOVA to test for significant differences in pHs between sites
legend("topright", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
title(xlab = "Site", cex.lab = 2.5, line = 3.5) #Add x-axis label
title(ylab = "pH", cex.lab = 2.5, line = 2.5) #Add y-axis label
TukeyHSD(siteANOVA) #Tukey HSD post-hoc test for pH differences between sites. All pairwise differences are significant at 0.05 level.
jpeg("2017-11-15-Environmental-Data-and-Biomarker-Analyses/2017-11-29-pH-Boxplot-Site-Only.jpeg", height = 1000, width = 2000)
boxplot(pHBoxplot$pH ~ pHBoxplot$Site, ylim = pHRange, main = "pH at Sites", cex.main = 3, cex.axis = 1.5) #Make boxplot based on sites and habitat
siteANOVA <- aov(pHBoxplot$pH ~ pHBoxplot$Site) #Perform an ANOVA to test for significant differences in pHs between sites
legend("topright", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
title(xlab = "Site", cex.lab = 2.5, line = 3.5) #Add x-axis label
title(ylab = "pH", cex.lab = 2.5, line = 2.5) #Add y-axis label
dev.off()
plot(pHData$WBE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Eelgrass") #Willapa Bay, Eelgrass
abline(h = median(pHData$WBE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$WBE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
mtext(side = 2, text = "pH (ºC)", line = 7, cex = 5, outer = TRUE) #Modify y-axis labels
plot(pHData$WBB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Bare") #Willapa Bay, Bare
abline(h = median(pHData$WBB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$WBB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$FBE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Eelgrass") #Fidgalo Bay, Eelgrass
abline(h = median(pHData$FBE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$FBE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$FBB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Bare") #FBB
abline(h = median(pHData$FBB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$FBB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$SKE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Eelgrass") #Skokomish River Delta, Eelgrass
abline(h = median(pHData$SKE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$SKE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$SKB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Bare") #Skokomish River Delta, Bare
abline(h = median(pHData$SKB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$SKB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$CIE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, type = "l", cex.main = 10, col = "red", main = "Case Inlet Eelgrass") #Case Inlet, Eelgrass
abline(h = median(pHData$CIE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$CIE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$CIB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange,  yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "red", main = "Case Inlet Bare") #Case Inlet, Bare
abline(h = median(pHData$CIB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$CIB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$PGB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Bare") #Port Gamble Bay, Bare
abline(h = median(pHData$PGE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$PGE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
axis(side = 1, at = seq(from = 1, to = length(pHData$Date), by = 144*5), lab = pHData$Date[seq(from = 1, to = length(pHData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
mtext(side = 1, text = "Date", line = 35, cex = 7) #Modify x-axis labels
boxplot(pHBoxplot$pH ~ pHBoxplot$Site, xaxt = "n", ylim = pHRange, yaxt = "n", main = "pH at Sites", cex.main = 10, cex.axis = 5, line.axis = 2, col = c("red", "blue", "magenta", "green", "dark gray")) #Make boxplot based on sites and habitat
siteANOVA <- aov(pHBoxplot$pH ~ pHBoxplot$Site) #Perform an ANOVA to test for significant differences in pH between sites
legend("topleft", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
axis(side = 1, at = 1:5, lab = c("CI", "FB", "PG", "SK", "WB"), cex.axis = 5, line = 10, lwd = 0, lwd.ticks = 0) #Make x-axis
mtext(side = 1, text = "Site", line = 35, cex = 7) #Modify x-axis label
jpeg("2017-11-15-Environmental-Data-and-Biomarker-Analyses/2017-11-29-Diurnal-pH-Fluctuations-and-Boxplot.jpeg", height = 6000, width = 4000)
par(mfrow = c(5,2)) #Create multipanel plot with 5 rows and 2 columns
par(mar = c(0, 0, 10, 0), oma = c(40, 15, 1, 1)) #Remove redundant white space and change outer margins
plot(pHData$WBE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Eelgrass") #Willapa Bay, Eelgrass
abline(h = median(pHData$WBE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$WBE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
mtext(side = 2, text = "pH (ºC)", line = 7, cex = 5, outer = TRUE) #Modify y-axis labels
plot(pHData$WBB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Bare") #Willapa Bay, Bare
abline(h = median(pHData$WBB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$WBB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$FBE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Eelgrass") #Fidgalo Bay, Eelgrass
abline(h = median(pHData$FBE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$FBE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$FBB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Bare") #FBB
abline(h = median(pHData$FBB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$FBB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$SKE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Eelgrass") #Skokomish River Delta, Eelgrass
abline(h = median(pHData$SKE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$SKE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$SKB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Bare") #Skokomish River Delta, Bare
abline(h = median(pHData$SKB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$SKB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$CIE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, type = "l", cex.main = 10, col = "red", main = "Case Inlet Eelgrass") #Case Inlet, Eelgrass
abline(h = median(pHData$CIE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$CIE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$CIB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange,  yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "red", main = "Case Inlet Bare") #Case Inlet, Bare
abline(h = median(pHData$CIB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$CIB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$PGB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Bare") #Port Gamble Bay, Bare
abline(h = median(pHData$PGE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$PGE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
axis(side = 1, at = seq(from = 1, to = length(pHData$Date), by = 144*5), lab = pHData$Date[seq(from = 1, to = length(pHData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
mtext(side = 1, text = "Date", line = 35, cex = 7) #Modify x-axis labels
boxplot(pHBoxplot$pH ~ pHBoxplot$Site, xaxt = "n", ylim = pHRange, yaxt = "n", main = "pH at Sites", cex.main = 10, cex.axis = 5, line.axis = 2, col = c("red", "blue", "magenta", "green", "dark gray")) #Make boxplot based on sites and habitat
siteANOVA <- aov(pHBoxplot$pH ~ pHBoxplot$Site) #Perform an ANOVA to test for significant differences in pH between sites
legend("topright", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
axis(side = 1, at = 1:5, lab = c("CI", "FB", "PG", "SK", "WB"), cex.axis = 5, line = 10, lwd = 0, lwd.ticks = 0) #Make x-axis
mtext(side = 1, text = "Site", line = 35, cex = 7) #Modify x-axis label
dev.off()
plot(pHData$PGB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Bare") #Port Gamble Bay, Bare
abline(h = median(pHData$PGE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$PGE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
abline(h = median(pHData$PGB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$PGB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
jpeg("2017-11-15-Environmental-Data-and-Biomarker-Analyses/2017-11-29-Diurnal-pH-Fluctuations-and-Boxplot.jpeg", height = 6000, width = 4000)
par(mfrow = c(5,2)) #Create multipanel plot with 5 rows and 2 columns
par(mar = c(0, 0, 10, 0), oma = c(40, 15, 1, 1)) #Remove redundant white space and change outer margins
plot(pHData$WBE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Eelgrass") #Willapa Bay, Eelgrass
abline(h = median(pHData$WBE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$WBE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
mtext(side = 2, text = "pH (ºC)", line = 7, cex = 5, outer = TRUE) #Modify y-axis labels
plot(pHData$WBB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Bare") #Willapa Bay, Bare
abline(h = median(pHData$WBB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$WBB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$FBE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Eelgrass") #Fidgalo Bay, Eelgrass
abline(h = median(pHData$FBE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$FBE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$FBB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Bare") #FBB
abline(h = median(pHData$FBB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$FBB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$SKE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Eelgrass") #Skokomish River Delta, Eelgrass
abline(h = median(pHData$SKE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$SKE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$SKB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Bare") #Skokomish River Delta, Bare
abline(h = median(pHData$SKB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$SKB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$CIE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, type = "l", cex.main = 10, col = "red", main = "Case Inlet Eelgrass") #Case Inlet, Eelgrass
abline(h = median(pHData$CIE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$CIE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$CIB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange,  yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "red", main = "Case Inlet Bare") #Case Inlet, Bare
abline(h = median(pHData$CIB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$CIB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$PGB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Bare") #Port Gamble Bay, Bare
abline(h = median(pHData$PGB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$PGB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
axis(side = 1, at = seq(from = 1, to = length(pHData$Date), by = 144*5), lab = pHData$Date[seq(from = 1, to = length(pHData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
mtext(side = 1, text = "Date", line = 35, cex = 7) #Modify x-axis labels
boxplot(pHBoxplot$pH ~ pHBoxplot$Site, xaxt = "n", ylim = pHRange, yaxt = "n", main = "pH at Sites", cex.main = 10, cex.axis = 5, line.axis = 2, col = c("red", "blue", "magenta", "green", "dark gray")) #Make boxplot based on sites and habitat
siteANOVA <- aov(pHBoxplot$pH ~ pHBoxplot$Site) #Perform an ANOVA to test for significant differences in pH between sites
legend("topright", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
axis(side = 1, at = 1:5, lab = c("CI", "FB", "PG", "SK", "WB"), cex.axis = 5, line = 10, lwd = 0, lwd.ticks = 0) #Make x-axis
mtext(side = 1, text = "Site", line = 35, cex = 7) #Modify x-axis label
dev.off()
plot(pHData$FBE, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Eelgrass") #Fidgalo Bay, Eelgrass
abline(h = median(pHData$FBE, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$FBE, na.rm = TRUE), lty = 2) #Add line depicting mean pH
plot(pHData$FBB, xlab = "", xaxt = "n", ylab = "", ylim = pHRange, yaxt = "n", cex.axis = 5, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Bare") #FBB
abline(h = median(pHData$FBB, na.rm = TRUE), lty = 1) #Add line depicting median pH
abline(h = mean(pHData$FBB, na.rm = TRUE), lty = 2) #Add line depicting mean pH
getwd()
environmentalData <- read.csv("../../data/DNR/2017-11-14-Environmental-Data-from-Micah.csv", header = TRUE, na.strings = "NA")
head(environmentalData)
colnames(environmentalData)
DOData <- environmentalData[,c(1:3,22:31)] #Save DO data as a new dataframe
head(DOData)
colnames(DOData) <- c("DateTime", "Date", "Time", "WBE", "WBB", "SKE", "SKB", "PGE", "PGB", "CIE", "CIB", "FBE", "FBB") #Rename columns
head(DOData)
DORange <- range(DOData$WBE, DOData$WBB, DOData$SKE, DOData$SKB, DOData$PGE, DOData$PGB, DOData$CIE, DOData$CIB, DOData$FBE, DOData$FBB, na.rm = TRUE) #Calculate range of DO values
DORange[1] <- 0 #Change minimum value to a round number
DORange <- range(DOData$WBE, DOData$WBB, DOData$SKE, DOData$SKB, DOData$PGE, DOData$PGB, DOData$CIE, DOData$CIB, DOData$FBE, DOData$FBB, na.rm = TRUE) #Calculate range of DO values
DORange[1] <- -5 #Change minimum value
DORange[2] <- 30 #Change maximum value to a believeable number
DORange #Confirm changes
plot(DOData$FBB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Bare") #FBB. Set up plot with no x axis labels, but with y-axis that encompasses maximum and minimum values
abline(h = median(DOData$FBB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$FBB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$FBE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Eelgrass") #Fidgalo Bay, Eelgrass
abline(h = median(DOData$FBE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$FBE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$PGB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Bare") #Port Gamble Bay, Bare
abline(h = median(DOData$PGB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$PGB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$PGE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Eelgrass") #Port Gamble Bay, Eelgrass
abline(h = median(DOData$PGE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$PGE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$SKB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Bare") #Skokomish River Delta, Bare
abline(h = median(DOData$SKB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$SKB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$SKE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Eelgrass") #Skokomish River Delta, Eelgrass
abline(h = median(DOData$SKE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$SKE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$CIB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "red", main = "Case Inlet Bare") #Case Inlet, Bare
abline(h = median(DOData$CIB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$CIB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$CIE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", type = "l", cex.main = 10, col = "red", main = "Case Inlet Eelgrass") #Case Inlet, Eelgrass
abline(h = median(DOData$CIE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$CIE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$WBB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Bare") #Willapa Bay, Bare
abline(h = median(DOData$WBB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$WBB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
mtext(side = 2, text = "DO (ºC)", line = 7, cex = 5, outer = TRUE) #Modify y-axis labels
axis(side = 1, at = seq(from = 1, to = length(DOData$Date), by = 144*5), lab = DOData$Date[seq(from = 1, to = length(DOData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
plot(DOData$WBE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Eelgrass") #Willapa Bay, Eelgrass
abline(h = median(DOData$WBE, na.rm = TRUE), lty = 1, text = "median") #Add line depicting median DO
abline(h = mean(DOData$WBE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
axis(side = 1, at = seq(from = 1, to = length(DOData$Date), by = 144*5), lab = DOData$Date[seq(from = 1, to = length(DOData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
mtext(side = 1, text = "Date", line = 25, cex = 5, outer = TRUE) #Modify x-axis labels
DORange[1] <- 0 #Change minimum value
DORange[2] <- 30 #Change maximum value to a believeable number
DORange <- range(DOData$WBE, DOData$WBB, DOData$SKE, DOData$SKB, DOData$PGE, DOData$PGB, DOData$CIE, DOData$CIB, DOData$FBE, DOData$FBB, na.rm = TRUE) #Calculate range of DO values
DORange[1] <- 0 #Change minimum value
DORange[2] <- 30 #Change maximum value to a believeable number
jpeg("2017-11-15-Environmental-Data-and-Biomarker-Analyses/2017-11-29-Diurnal-DO-Fluctuations.jpeg", height = 6000, width = 4000)
par(mfrow = c(5,2)) #Create multipanel plot with 5 rows and 2 columns
par(mar = c(0, 0, 10, 0), oma = c(30, 15, 1, 1)) #Remove redundant white space and change outer margins
plot(DOData$FBB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Bare") #FBB. Set up plot with no x axis labels, but with y-axis that encompasses maximum and minimum values
abline(h = median(DOData$FBB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$FBB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$FBE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Eelgrass") #Fidgalo Bay, Eelgrass
abline(h = median(DOData$FBE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$FBE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$PGB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Bare") #Port Gamble Bay, Bare
abline(h = median(DOData$PGB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$PGB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$PGE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Eelgrass") #Port Gamble Bay, Eelgrass
abline(h = median(DOData$PGE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$PGE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$SKB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Bare") #Skokomish River Delta, Bare
abline(h = median(DOData$SKB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$SKB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$SKE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Eelgrass") #Skokomish River Delta, Eelgrass
abline(h = median(DOData$SKE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$SKE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$CIB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "red", main = "Case Inlet Bare") #Case Inlet, Bare
abline(h = median(DOData$CIB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$CIB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$CIE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", type = "l", cex.main = 10, col = "red", main = "Case Inlet Eelgrass") #Case Inlet, Eelgrass
abline(h = median(DOData$CIE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$CIE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$WBB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Bare") #Willapa Bay, Bare
abline(h = median(DOData$WBB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$WBB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
mtext(side = 2, text = "DO (ºC)", line = 7, cex = 5, outer = TRUE) #Modify y-axis labels
axis(side = 1, at = seq(from = 1, to = length(DOData$Date), by = 144*5), lab = DOData$Date[seq(from = 1, to = length(DOData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
plot(DOData$WBE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Eelgrass") #Willapa Bay, Eelgrass
abline(h = median(DOData$WBE, na.rm = TRUE), lty = 1, text = "median") #Add line depicting median DO
abline(h = mean(DOData$WBE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
axis(side = 1, at = seq(from = 1, to = length(DOData$Date), by = 144*5), lab = DOData$Date[seq(from = 1, to = length(DOData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
mtext(side = 1, text = "Date", line = 25, cex = 5, outer = TRUE) #Modify x-axis labels
dev.off()
jpeg("2017-11-15-Environmental-Data-and-Biomarker-Analyses/2017-11-29-Diurnal-DO-Fluctuations.jpeg", height = 6000, width = 4000)
par(mfrow = c(5,2)) #Create multipanel plot with 5 rows and 2 columns
par(mar = c(0, 0, 10, 0), oma = c(30, 15, 1, 1)) #Remove redundant white space and change outer margins
plot(DOData$FBB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Bare") #FBB. Set up plot with no x axis labels, but with y-axis that encompasses maximum and minimum values
abline(h = median(DOData$FBB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$FBB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$FBE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Eelgrass") #Fidgalo Bay, Eelgrass
abline(h = median(DOData$FBE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$FBE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$PGB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Bare") #Port Gamble Bay, Bare
abline(h = median(DOData$PGB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$PGB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$PGE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Eelgrass") #Port Gamble Bay, Eelgrass
abline(h = median(DOData$PGE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$PGE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$SKB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Bare") #Skokomish River Delta, Bare
abline(h = median(DOData$SKB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$SKB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$SKE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Eelgrass") #Skokomish River Delta, Eelgrass
abline(h = median(DOData$SKE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$SKE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$CIB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "red", main = "Case Inlet Bare") #Case Inlet, Bare
abline(h = median(DOData$CIB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$CIB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$CIE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", type = "l", cex.main = 10, col = "red", main = "Case Inlet Eelgrass") #Case Inlet, Eelgrass
abline(h = median(DOData$CIE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$CIE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$WBB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Bare") #Willapa Bay, Bare
abline(h = median(DOData$WBB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$WBB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
mtext(side = 2, text = "DO (ºC)", line = 7, cex = 5, outer = TRUE) #Modify y-axis labels
axis(side = 1, at = seq(from = 1, to = length(DOData$Date), by = 144*5), lab = DOData$Date[seq(from = 1, to = length(DOData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
plot(DOData$WBE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Eelgrass") #Willapa Bay, Eelgrass
abline(h = median(DOData$WBE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$WBE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
axis(side = 1, at = seq(from = 1, to = length(DOData$Date), by = 144*5), lab = DOData$Date[seq(from = 1, to = length(DOData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
mtext(side = 1, text = "Date", line = 25, cex = 5, outer = TRUE) #Modify x-axis labels
dev.off()
DOBoxplotCIB <- data.frame(Date.Time = DOData$DateTime,
Site = rep(x = "CI", times = length(DOData$DateTime)),
Habitat = rep(x = "Bare", times = length(DOData$DateTime)),
DO = DOData$CIB) #Create a dataframe for CIB data
DOBoxplotCIB <- DOBoxplotCIB[-c(7489:7490),] #Remove last two rows
DOBoxplotCIE <- data.frame(Date.Time = DOData$DateTime,
Site = rep(x = "CI", times = length(DOData$DateTime)),
Habitat = rep(x = "Eelgrass", times = length(DOData$DateTime)),
DO = DOData$CIE) #Create a dataframe for CIE data
DOBoxplotCIE <- DOBoxplotCIE[-c(7489:7490),] #Remove last two rows
DOBoxplotFBB <- data.frame(Date.Time = DOData$DateTime,
Site = rep(x = "FB", times = length(DOData$DateTime)),
Habitat = rep(x = "Bare", times = length(DOData$DateTime)),
DO = DOData$FBB) #Create a dataframe for FBB data
DOBoxplotFBB <- DOBoxplotFBB[-c(7489:7490),] #Remove last two rows
DOBoxplotFBE <- data.frame(Date.Time = DOData$DateTime,
Site = rep(x = "FB", times = length(DOData$DateTime)),
Habitat = rep(x = "Eelgrass", times = length(DOData$DateTime)),
DO = DOData$FBE) #Create a dataframe for FBE data
DOBoxplotFBE <- DOBoxplotFBE[-c(7489:7490),] #Remove last two rows
DOBoxplotPGB <- data.frame(Date.Time = DOData$DateTime,
Site = rep(x = "PG", times = length(DOData$DateTime)),
Habitat = rep(x = "Bare", times = length(DOData$DateTime)),
DO = DOData$PGB) #Create a dataframe for PGB data
DOBoxplotPGB <- DOBoxplotPGB[-c(7489:7490),] #Remove last two rows
DOBoxplotPGE <- data.frame(Date.Time = DOData$DateTime,
Site = rep(x = "PG", times = length(DOData$DateTime)),
Habitat = rep(x = "Eelgrass", times = length(DOData$DateTime)),
DO = DOData$PGE) #Create a dataframe for PGE data
DOBoxplotPGE <- DOBoxplotPGE[-c(7489:7490),] #Remove last two rows
DOBoxplotSKB <- data.frame(Date.Time = DOData$DateTime,
Site = rep(x = "SK", times = length(DOData$DateTime)),
Habitat = rep(x = "Bare", times = length(DOData$DateTime)),
DO = DOData$SKB) #Create a dataframe for SKB data
DOBoxplotSKB <- DOBoxplotSKB[-c(7489:7490),] #Remove last two rows
DOBoxplotSKE <- data.frame(Date.Time = DOData$DateTime,
Site = rep(x = "SK", times = length(DOData$DateTime)),
Habitat = rep(x = "Eelgrass", times = length(DOData$DateTime)),
DO = DOData$SKE) #Create a dataframe for SKE data
DOBoxplotSKE <- DOBoxplotSKE[-c(7489:7490),] #Remove last two rows
DOBoxplotWBB <- data.frame(Date.Time = DOData$DateTime,
Site = rep(x = "WB", times = length(DOData$DateTime)),
Habitat = rep(x = "Bare", times = length(DOData$DateTime)),
DO = DOData$WBB) #Create a dataframe for WBB data
DOBoxplotWBB <- DOBoxplotWBB[-c(7489:7490),] #Remove last two rows
DOBoxplotWBE <- data.frame(Date.Time = DOData$DateTime,
Site = rep(x = "WB", times = length(DOData$DateTime)),
Habitat = rep(x = "Eelgrass", times = length(DOData$DateTime)),
DO = DOData$WBE) #Create a dataframe for WBE data
DOBoxplotWBE <- DOBoxplotWBE[-c(7489:7490),] #Remove last two rows
DOBoxplot <- rbind(DOBoxplotCIB, DOBoxplotCIE, DOBoxplotFBB, DOBoxplotFBE, DOBoxplotPGB, DOBoxplotPGE, DOBoxplotSKB, DOBoxplotSKE, DOBoxplotWBB, DOBoxplotWBE)
boxplot(DOBoxplot$DO ~ DOBoxplot$Site + DOBoxplot$Habitat, ylim = DORange, names = c("CI.Bare", "FB.Bare", "PG.Bare", "SK.Bare", "WB.Bare", "CI.Eelgrass", "FB.Eelgrass", "PG.Eelgrass", "SK.Eelgrass", "WB.Eelgrass"), col = rep(c("red", "blue", "magenta", "green", "white"), times = 2), main = "DO at Site and Habitats", cex.main = 5, cex.axis = 1.5) #Make boxplot based on sites and habitat
boxplot(DOBoxplot$DO ~ DOBoxplot$Site, ylim = DORange, main = "DO at Sites", cex.main = 3, cex.axis = 1.5) #Make boxplot based on sites and habitat
siteANOVA <- aov(DOBoxplot$DO ~ DOBoxplot$Site) #Perform an ANOVA to test for significant differences in DOs between sites
legend("topleft", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
title(xlab = "Site", cex.lab = 2.5, line = 3.5) #Add x-axis label
title(ylab = "DO (ºC)", cex.lab = 2.5, line = 2.2) #Add y-axis label
jpeg("2017-11-15-Environmental-Data-and-Biomarker-Analyses/2017-11-29-Diurnal-DO-Fluctuations.jpeg", height = 6000, width = 4000)
par(mfrow = c(5,2)) #Create multipanel plot with 5 rows and 2 columns
par(mar = c(0, 0, 10, 0), oma = c(30, 15, 1, 1)) #Remove redundant white space and change outer margins
plot(DOData$FBB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Bare") #FBB. Set up plot with no x axis labels, but with y-axis that encompasses maximum and minimum values
abline(h = median(DOData$FBB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$FBB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$FBE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "blue", main = "Fidalgo Bay Eelgrass") #Fidgalo Bay, Eelgrass
abline(h = median(DOData$FBE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$FBE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$PGB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Bare") #Port Gamble Bay, Bare
abline(h = median(DOData$PGB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$PGB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$PGE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "magenta", main = "Port Gamble Bay Eelgrass") #Port Gamble Bay, Eelgrass
abline(h = median(DOData$PGE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$PGE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$SKB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Bare") #Skokomish River Delta, Bare
abline(h = median(DOData$SKB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$SKB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$SKE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "green", main = "Skokomish River Delta Eelgrass") #Skokomish River Delta, Eelgrass
abline(h = median(DOData$SKE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$SKE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$CIB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "red", main = "Case Inlet Bare") #Case Inlet, Bare
abline(h = median(DOData$CIB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$CIB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$CIE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", type = "l", cex.main = 10, col = "red", main = "Case Inlet Eelgrass") #Case Inlet, Eelgrass
abline(h = median(DOData$CIE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$CIE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
plot(DOData$WBB, xlab = "", xaxt = "n", ylab = "", ylim = DORange, cex.axis = 5, cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Bare") #Willapa Bay, Bare
abline(h = median(DOData$WBB, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$WBB, na.rm = TRUE), lty = 2) #Add line depicting mean DO
mtext(side = 2, text = "Dissolved Oxygen Content", line = 7, cex = 5, outer = TRUE) #Modify y-axis labels
axis(side = 1, at = seq(from = 1, to = length(DOData$Date), by = 144*5), lab = DOData$Date[seq(from = 1, to = length(DOData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
plot(DOData$WBE, xlab = "", xaxt = "n", ylab = "", ylim = DORange, yaxt = "n", cex.main = 10, type = "l", col = "dark grey", main = "Willapa Bay Eelgrass") #Willapa Bay, Eelgrass
abline(h = median(DOData$WBE, na.rm = TRUE), lty = 1) #Add line depicting median DO
abline(h = mean(DOData$WBE, na.rm = TRUE), lty = 2) #Add line depicting mean DO
axis(side = 1, at = seq(from = 1, to = length(DOData$Date), by = 144*5), lab = DOData$Date[seq(from = 1, to = length(DOData$Date), by = 144*5)], las = 3, cex.axis = 5, line = 2) #Make x-axis
mtext(side = 1, text = "Date", line = 25, cex = 5, outer = TRUE) #Modify x-axis labels
dev.off()
TukeyHSD(siteANOVA) #Tukey HSD post-hoc test for DO differences between sites. All pairwise differences are significant at 0.05 level.
boxplot(DOBoxplot$DO ~ DOBoxplot$Site, ylim = DORange, main = "DO at Sites", cex.main = 3, cex.axis = 1.5) #Make boxplot based on sites and habitat
siteANOVA <- aov(DOBoxplot$DO ~ DOBoxplot$Site) #Perform an ANOVA to test for significant differences in DOs between sites
legend("topleft", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
title(xlab = "Site", cex.lab = 2.5, line = 3.5) #Add x-axis label
title(ylab = "Dissolved Oxygen Content", cex.lab = 2.5, line = 2.2) #Add y-axis label
jpeg("2017-11-15-Environmental-Data-and-Biomarker-Analyses/2017-11-29-DO-Boxplot-Site-Only.jpeg", height = 1000, width = 2000)
boxplot(DOBoxplot$DO ~ DOBoxplot$Site, ylim = DORange, main = "DO at Sites", cex.main = 3, cex.axis = 1.5) #Make boxplot based on sites and habitat
siteANOVA <- aov(DOBoxplot$DO ~ DOBoxplot$Site) #Perform an ANOVA to test for significant differences in DOs between sites
legend("topleft", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
title(xlab = "Site", cex.lab = 2.5, line = 3.5) #Add x-axis label
title(ylab = "Dissolved Oxygen Content", cex.lab = 2.5, line = 2.2) #Add y-axis label
dev.off()
jpeg("2017-11-15-Environmental-Data-and-Biomarker-Analyses/2017-11-29-DO-Boxplot-Site-Only.jpeg", height = 1000, width = 2000)
boxplot(DOBoxplot$DO ~ DOBoxplot$Site, ylim = DORange, main = "DO at Sites", cex.main = 3, cex.axis = 1.5) #Make boxplot based on sites and habitat
siteANOVA <- aov(DOBoxplot$DO ~ DOBoxplot$Site) #Perform an ANOVA to test for significant differences in DOs between sites
legend("topleft", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
title(xlab = "Site", cex.lab = 2.5, line = 3.5) #Add x-axis label
title(ylab = "Dissolved Oxygen Content", cex.lab = 2.5, line = 2.5) #Add y-axis label
dev.off()
SRMDataNMDSAveragedCorrected <- read.csv("2017-10-10-Troubleshooting/2017-11-05-Integrated-Dataset/2017-11-05-Averaged-Areas-Pivoted-Corrected.csv", header = TRUE) #Import modified dataset. This dataset has rownames as the first column, column names as sample IDs. Area data is averaged and corrected (no NAs)
rownames(SRMDataNMDSAveragedCorrected) <- SRMDataNMDSAveragedCorrected[,1]
SRMDataNMDSAveragedCorrected <- SRMDataNMDSAveragedCorrected[,-1] #Remove first column of rownames
head(SRMDataNMDSAveragedCorrected) #Confirm import.
SRMDataNMDSAveragedCorrectedTransposed <- data.frame(t(SRMDataNMDSAveragedCorrected)) #Transpose the data
SRMDataNMDSAveragedCorrectedTransposed$Sample.Number <- rownames(SRMDataNMDSAveragedCorrectedTransposed) #Save rownames as a new column
head(SRMDataNMDSAveragedCorrectedTransposed) #Confirm changes
biologicalReplicates <- read.csv("2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-10-25-Biological-Replicate-Information-SampleID-Only.csv", na.strings = "N/A") #Import site and eelgrass condition information (i.e. biological replicate information)
head(biologicalReplicates) #Confirm import
colnames(biologicalReplicates) <- c("Sample.Number", "Site", "Eelgrass.Condition")
rownames(biologicalReplicates) <- biologicalReplicates$Sample.Number #Set sample number as row names
head(biologicalReplicates) #Confirm changes
biologicalReplicates$Site <- factor(biologicalReplicates$Site) #Remove 0 as a factor
biologicalReplicates$Eelgrass.Condition <- factor(biologicalReplicates$Eelgrass.Condition) #Remove 0 as a factor
str(biologicalReplicates) #Confirm factor reset
boxplotData <- merge(x = biologicalReplicates, y = SRMDataNMDSAveragedCorrectedTransposed, by = "Sample.Number") #Merge together
head(boxplotData) #Confirm merge
rownames(boxplotData) <- boxplotData$Sample.Number #Set sample number as row names
boxplotData <- boxplotData[-1] #Remove Sample.Number column
head(boxplotData) #Confirm changes
boxplotFilenames <- data.frame(protein = colnames(boxplotData),
modifier = rep(".jpeg", length(boxplotData))) #Make filename sheet
boxplotFilenames$siteFilenames <- paste(boxplotFilenames$protein, boxplotFilenames$modifier) #Make a new column for the site only filenames
head(boxplotFilenames) #Confirm changes
environmentalData <- read.csv("../../data/DNR/2017-11-14-Environmental-Data-from-Micah.csv", header = TRUE, na.strings = "NA")
head(environmentalData)
colnames(environmentalData)
temperatureData <- environmentalData[,c(1:3,32:41)] #Save temperature data as a new dataframe
head(temperatureData)
colnames(temperatureData) <- c("DateTime", "Date", "Time", "WBE", "WBB", "SKE", "SKB", "PGE", "PGB", "CIE", "CIB", "FBE", "FBB") #Rename columns
head(temperatureData)
willapaMaxTemp <- max(temperatureData$WBE, temperatureData$WBB, na.rm = TRUE)
willapaMinTemp <- min(temperatureData$WBE, temperatureData$WBB, na.rm = TRUE) #Max = 30.4
willapaMedTemp <- median(temperatureData$WBE, temperatureData$WBB, na.rm = TRUE) #Max = 30.4
willapaModeTemp <- mode(temperatureData$WBE, temperatureData$WBB, na.rm = TRUE) #Max = 30.4
willapaMeanTemp <- mean(temperatureData$WBE, temperatureData$WBB, na.rm = TRUE) #Mean = 17.9
willapaMeanTemp <- ave(temperatureData$WBE, temperatureData$WBB, na.rm = TRUE) #Mean = 17.9
willapaMeanTemp <- average(temperatureData$WBE, temperatureData$WBB, na.rm = TRUE) #Mean = 17.9
willapaMeanTemp <- mean(temperatureData$WBE, temperatureData$WBB, na.rm = TRUE) #Mean = 17.9
pugetSoundMaxTemp <- max(temperatureData[,6:13], na.rm = TRUE) #Max = 30.4
pugetSoundMinTemp <- min(temperatureData[,6:13], na.rm = TRUE) #Min = 11.2
pugetSoundMedTemp <- median(temperatureData[,6:13], na.rm = TRUE) #Med = 17.9
pugetSoundMedTemp <- median(temperatureData$SKE, temperatureData$SKB, na.rm = TRUE) #Med = 17.9
pugetSoundMedTemp <- median(temperatureData$SKE, temperatureData$SKB, temperatureData$PGE, temperatureData$PGB, temperatureData$CIE, temperatureData$CIB, temperatureData$FBE, temperatureData$FBB, na.rm = TRUE) #Med = 17.9
pugetSoundMinTemp <- min(temperatureData$SKE, temperatureData$SKB, temperatureData$PGE, temperatureData$PGB, temperatureData$CIE, temperatureData$CIB, temperatureData$FBE, temperatureData$FBB, na.rm = TRUE) #Min = 11.1
pugetSoundMaxTemp <- max(temperatureData$SKE, temperatureData$SKB, temperatureData$PGE, temperatureData$PGB, temperatureData$CIE, temperatureData$CIB, temperatureData$FBE, temperatureData$FBB, na.rm = TRUE) #Max = 36
boxplotFilenames$siteFilenames
boxplot(boxplotData[,22] ~ boxplotData$Site, xlab = "Sites", ylab = "", cex.lab = 2, cex.axis = 1.5) #Create the boxplot
title(ylab = "Abundance", line = 2.3, cex.lab = 2) #Add the y-axis label
stripchart(boxplotData[,i] ~ boxplotData$Site, vertical = TRUE, method = "jitter", add = TRUE, pch = 20, col = 'blue') #Add each data point
stripchart(boxplotData[,22] ~ boxplotData$Site, vertical = TRUE, method = "jitter", add = TRUE, pch = 20, col = 'blue') #Add each data point
siteANOVA <- aov(boxplotData[,i] ~ boxplotData$Site) #Perform an ANOVA to test for significant differences between sites
siteANOVA <- aov(boxplotData[,22] ~ boxplotData$Site) #Perform an ANOVA to test for significant differences between sites
legend("topleft", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
title(boxplotFilenames$protein[22])
title("Heat Shock Protein Abundance by Site")
tempRange <- range(temperatureData$WBE, temperatureData$WBB, temperatureData$SKE, temperatureData$SKB, temperatureData$PGE, temperatureData$PGB, temperatureData$CIE, temperatureData$CIB, temperatureData$FBE, temperatureData$FBB, na.rm = TRUE) #Calculate range of temperature values
tempRange[1] <- 10 #Change minimum value to a round number
tempRange #Confirm changes
axis(side = 4, at = tempRange, lab = tempRange, cex.axis = 1.5) #Create secondary y-axis
boxplot(boxplotData[,22] ~ boxplotData$Site, xlab = "Sites", ylab = "", cex.lab = 2, cex.axis = 1.5) #Create the boxplot
axis(side = 4, at = tempRange, lab = tempRange, cex.axis = 1.5) #Create secondary y-axis
axis(side = 4, at = tempRange, lab = tempRange, cex.axis = 1.5, line = 0) #Create secondary y-axis
axis(side = 4, at = tempRange, lab = tempRange, cex.axis = 1.5, line = 2) #Create secondary y-axis
axis(side = 4, ylim = tempRange, cex.axis = 1.5, line = 2) #Create secondary y-axis
axis(side = 4, ylim = tempRange) #Create secondary y-axis
boxplot(boxplotData[,22] ~ boxplotData$Site, xlab = "Sites", ylab = "", cex.lab = 2, cex.axis = 1.5) #Create the boxplot
axis(side = 4, ylim = tempRange) #Create secondary y-axis
par(new = TRUE)
axis(side = 4, ylim = tempRange) #Create secondary y-axis
boxplot(boxplotData[,22] ~ boxplotData$Site, xlab = "Sites", ylab = "", cex.lab = 2, cex.axis = 1.5) #Create the boxplot
title(ylab = "Abundance", line = 2.5, cex.lab = 2) #Add the y-axis label
stripchart(boxplotData[,22] ~ boxplotData$Site, vertical = TRUE, method = "jitter", add = TRUE, pch = 20, col = 'blue') #Add each data point
siteANOVA <- aov(boxplotData[,22] ~ boxplotData$Site) #Perform an ANOVA to test for significant differences between sites
legend("topleft", bty = "n", legend = paste("F =", format(summary(siteANOVA)[[1]][["F value"]][[1]], digits = 4), "p =", format(summary(siteANOVA)[[1]][["Pr(>F)"]][[1]], digits = 4))) #Add F and p-value from ANOVA
title("Heat Shock Protein Abundance by Site")
par(new = TRUE)
axis(side = 4, ylim = tempRange) #Create secondary y-axis
axis(side = 4, at = tempRange) #Create secondary y-axis
getwd()
