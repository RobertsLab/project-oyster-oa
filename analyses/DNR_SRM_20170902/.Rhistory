head(ANOSIMReplicates) #Confirm changes
dissimArea.t <- vegdist(area.t, "euclidean") #Calculate dissimilarity matrix
ANOSIMReplicates <- biologicalReplicates #Duplicate dataframe
row.names(ANOSIMReplicates) <- ANOSIMReplicates[,1] #Assign sample numbers as row names
ANOSIMReplicates <- ANOSIMReplicates[,-1] #Remove Sample.Number column
head(ANOSIMReplicates) #Confirm changes
ANOSIMReplicates$eelgrassCondition <- factor(ANOSIMReplicates$eelgrassCondition) #Make sure residual factors are no longer present
ANOSIMReplicates$site <- factor(ANOSIMReplicates$site) #Make sure residual factors are no longer present
str(ANOSIMReplicates) #Confirm new factors
ANOSIMReplicates$siteEelgrass <- paste(ANOSIMReplicates$site, ANOSIMReplicates$eelgrassCondition) #Create third column for two-way ANOSIM
head(ANOSIMReplicates) #Confirm changes
siteEelgrassANOSIm <- anosim(dat = dissimArea.t, grouping = ANOSIMReplicates[,1:2])
siteEelgrassANOSIm <- anosim(dat = dissimArea.t, grouping = ANOSIMReplicates[,3]) #Two-way ANOSIM by eelgrass and site
siteEelgrassANOSIM <- anosim(dat = dissimArea.t, grouping = ANOSIMReplicates[,3]) #Two-way ANOSIM by eelgrass and site
summary(siteEelgrassANOSIM)
plot(siteEelgrassANOSIM)
getwd() #Confirm changes
SRMAveragedAreasPivoted <- read.csv("2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-10-30-Protein-Areas-for-Boxplots.csv", header = TRUE) #Import modified dataset
head(SRMAveragedAreasPivoted) #Confirm import.
rownames(SRMAveragedAreasPivoted) <- SRMAveragedAreasPivoted[,1] #Set first column as rownames
SRMAveragedAreasPivoted <- SRMAveragedAreasPivoted[,-1] #Remove first column
head(SRMAveragedAreasPivoted) #Confirm changes
SRMAveragedAreasPivotedCorrected <- SRMAveragedAreasPivoted #Duplicate dataframe
SRMAveragedAreasPivotedCorrected[is.na(SRMAveragedAreasPivotedCorrected)] <- 0 #Replace NAs with 0s
head(SRMAveragedAreasPivotedCorrected) #Confirm there are no NAs
source("biostats.R") #Either load the source R script or copy paste. Must run this code before NMDS.
library(vegan)
area.protID <- SRMAveragedAreasPivotedCorrected #Save all area data as a new dataframe
head(area.protID) #Confirm change
area.t <- t(area.protID) #Transpose the file so that rows and columns are switched
head(area.t) #Confirm transposition
area.tra <- (area.t+1) #Add 1 to all values before transforming
area.tra <- data.trans(area.tra, method = 'log', plot = FALSE) #log(x+1) transformation
proc.nmds.norm.averaged.euclidean <- metaMDS(area.t, distance = 'euclidean', k = 2, trymax = 10000, autotransform = FALSE) #Make MDS dissimilarity matrix using euclidean distance. Julian confirmed that I should use euclidean distances, and not bray-curtis
ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "points", display = "sites") #Plot basic NMDS
sampleIDs <- c("O01", "O04", "O06", "O08", "O10", "O100", "O101", "O102", "O103", "O106", "O118", "O121", "O122", "O124", "O128", "O131", "O137", "O14", "O140", "O145", "O147", "O17", "O21", "O22", "O24", "O26", "O30", "O31", "O32", "O35", "O40", "O43", "O46", "O49", "O51", "O52", "O56", "O60", "O64", "O66", "O71", "O78", "O90", "O91", "O96", "O99") #Create a sample ID vector
biologicalReplicates <- read.csv("2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-10-25-Biological-Replicate-Information-SampleID-Only.csv", header = TRUE) #Import biological replicate information
head(biologicalReplicates) #Confirm import
biologicalReplicates <- biologicalReplicates[,-2] #Remove bare/eelgrass distinction column
head(biologicalReplicates) #Confirm changes
temporaryData <- data.frame(sampleIDs = sampleIDs,
y = rep(x = 0, times = length(sampleIDs))) #Create a temporary dataframe with sample IDs used in NMDS
head(temporaryData) #Confirm dataframe creation
NMDSColorCustomization
NMDSColorCustomization <- merge(x = temporaryData, y = biologicalReplicates, by = "sampleIDs") #Merge biological information with samples used
head(NMDSColorCustomization) #Confirm merge
biologicalReplicates <- read.csv("2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-10-25-Biological-Replicate-Information-SampleID-Only.csv", header = TRUE) #Import biological replicate information
head(biologicalReplicates) #Confirm import
biologicalReplicates <- biologicalReplicates[,-3] #Remove bare/eelgrass distinction column
head(biologicalReplicates) #Confirm changes
temporaryData <- data.frame(sampleIDs = sampleIDs,
y = rep(x = 0, times = length(sampleIDs))) #Create a temporary dataframe with sample IDs used in NMDS
head(temporaryData) #Confirm dataframe creation
NMDSColorCustomization <- merge(x = temporaryData, y = biologicalReplicates, by = "sampleIDs") #Merge biological information with samples used
head(NMDSColorCustomization) #Confirm merge
tail(NMDSColorCustomization) #Confirm merge
NMDSColorCustomization <- NMDSColorCustomization[, -2] #Remove empty column
tail(NMDSColorCustomization) #Confirm removal
NMDSColorCustomization$sampleIDs #Confirm all sample IDs are there
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(site),] #Reorder so sites are sorted alphabetically
head(NMDSColorCustomization) #Confirm sorting
detach(NMDSColorCustomization)
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorCustomization$site == "FB")),
rep(x = "black", times = sum(NMDSColorCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorCustomization$site == "SK")),
rep(x = "magenta", times = sum(NMDSColorCustomization$site == "WB"))) #Create a color vector
NMDSColorCustomization[,4] <- NMDS.Colors #Add the color vector to the dataframe
NMDSColorCustomization[,3] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorCustomization) #Confirm addition
colnames(NMDSColorCustomization) <- c("Sample.Number", "Site", "Color") #Change column names
head(NMDSColorCustomization) #Confirm change
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorShapeCustomization$Color, pch = NMDSColorShapeCustomization$Shape)
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorCustomization$Color, pch = 16)
points(fig.nmds, "sites", col = NMDSColorCustomization$Color, pch = 17)
points(fig.nmds, "sites", col = NMDSColorCustomization$Color, pch = 19)
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorCustomization$Color, pch = 19)
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorCustomization$Color, pch = 16)
legend("topright", cex = .5, pch = c(rep(x = 16, times = 5)), legend=c('Case Inlet', "Fidalgo Bay", "Willapa Bay", "Skokomish", "Port Gamble"), col=c('red', 'blue', 'black', 'green', 'magenta'))
title("Protein Expression Similarities between Sites and Habitats")
NMDS.Colors
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
NMDSColorCustomization
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(site),] #Reorder so sites are sorted alphabetically
NMDSColorCustomization
NMDSColorCustomization <- NMDSColorCustomization[order(Site),] #Reorder so sites are sorted alphabetically
NMDSColorCustomization <- NMDSColorCustomization[order(Site),] #Reorder so sites are sorted alphabetically
head(NMDSColorCustomization) #Confirm sorting
detach(NMDSColorCustomization)
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorCustomization$site == "FB")),
rep(x = "black", times = sum(NMDSColorCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorCustomization$site == "SK")),
rep(x = "magenta", times = sum(NMDSColorCustomization$site == "WB"))) #Create a color vector
NMDSColorCustomization[,3] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorCustomization) #Confirm addition
colnames(NMDSColorCustomization) <- c("Sample.Number", "Site", "Color") #Change column names
head(NMDSColorCustomization) #Confirm change
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorCustomization$site == "FB")),
rep(x = "black", times = sum(NMDSColorCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorCustomization$site == "SK")),
rep(x = "magenta", times = sum(NMDSColorCustomization$site == "WB"))) #Create a color vector
NMDSColorCustomization[,3] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorCustomization) #Confirm addition
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorCustomization$site == "FB")),
rep(x = "black", times = sum(NMDSColorCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorCustomization$site == "SK")),
rep(x = "magenta", times = sum(NMDSColorCustomization$site == "WB"))) #Create a color vector
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorCustomization$Site == "CI")),
rep(x = "blue", times = sum(NMDSColorCustomization$Site == "FB")),
rep(x = "black", times = sum(NMDSColorCustomization$Site == "PG")),
rep(x = "green", times = sum(NMDSColorCustomization$Site == "SK")),
rep(x = "magenta", times = sum(NMDSColorCustomization$Site == "WB"))) #Create a color vector
NMDSColorCustomization[,3] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorCustomization) #Confirm addition
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(Site),] #Reorder so sites are sorted alphabetically
head(NMDSColorCustomization) #Confirm sorting
detach(NMDSColorCustomization)
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorCustomization$Site == "CI")),
rep(x = "blue", times = sum(NMDSColorCustomization$Site == "FB")),
rep(x = "magenta", times = sum(NMDSColorCustomization$Site == "PG")),
rep(x = "green", times = sum(NMDSColorCustomization$Site == "SK")),
rep(x = "black", times = sum(NMDSColorCustomization$Site == "WB"))) #Create a color vector
NMDSColorCustomization[,3] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorCustomization) #Confirm addition
colnames(NMDSColorCustomization) <- c("Sample.Number", "Site", "Color") #Change column names
head(NMDSColorCustomization) #Confirm change
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorCustomization$Color, pch = 16)
NMDSColorCustomization
SRMAveragedAreasPivoted <- read.csv("2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-10-30-Protein-Areas-for-Boxplots.csv", header = TRUE) #Import modified dataset
head(SRMAveragedAreasPivoted) #Confirm import.
rownames(SRMAveragedAreasPivoted) <- SRMAveragedAreasPivoted[,1] #Set first column as rownames
SRMAveragedAreasPivoted <- SRMAveragedAreasPivoted[,-1] #Remove first column
head(SRMAveragedAreasPivoted) #Confirm changes
SRMAveragedAreasPivotedCorrected <- SRMAveragedAreasPivoted #Duplicate dataframe
SRMAveragedAreasPivotedCorrected[is.na(SRMAveragedAreasPivotedCorrected)] <- 0 #Replace NAs with 0s
head(SRMAveragedAreasPivotedCorrected) #Confirm there are no NAs
source("biostats.R") #Either load the source R script or copy paste. Must run this code before NMDS.
library(vegan)
area.protID <- SRMAveragedAreasPivotedCorrected #Save all area data as a new dataframe
head(area.protID) #Confirm change
area.t <- t(area.protID) #Transpose the file so that rows and columns are switched
head(area.t) #Confirm transposition
area.tra <- (area.t+1) #Add 1 to all values before transforming
area.tra <- data.trans(area.tra, method = 'log', plot = FALSE) #log(x+1) transformation
proc.nmds.norm.averaged.euclidean <- metaMDS(area.t, distance = 'euclidean', k = 2, trymax = 10000, autotransform = FALSE) #Make MDS dissimilarity matrix using euclidean distance. Julian confirmed that I should use euclidean distances, and not bray-curtis
ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "points", display = "sites") #Plot basic NMDS
sampleIDs <- c("O01", "O04", "O06", "O08", "O10", "O100", "O101", "O102", "O103", "O106", "O118", "O121", "O122", "O124", "O128", "O131", "O137", "O14", "O140", "O145", "O147", "O17", "O21", "O22", "O24", "O26", "O30", "O31", "O32", "O35", "O40", "O43", "O46", "O49", "O51", "O52", "O56", "O60", "O64", "O66", "O71", "O78", "O90", "O91", "O96", "O99") #Create a sample ID vector
biologicalReplicates <- read.csv("2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-10-25-Biological-Replicate-Information-SampleID-Only.csv", header = TRUE) #Import biological replicate information
head(biologicalReplicates) #Confirm import
temporaryData <- data.frame(sampleIDs = sampleIDs,
y = rep(x = 0, times = length(sampleIDs))) #Create a temporary dataframe with sample IDs used in NMDS
head(temporaryData) #Confirm dataframe creation
NMDSColorCustomization <- merge(x = temporaryData, y = biologicalReplicates, by = "sampleIDs") #Merge biological information with samples used
head(NMDSColorCustomization) #Confirm merge
tail(NMDSColorCustomization) #Confirm merge
NMDSColorCustomization <- NMDSColorCustomization[, -2] #Remove empty column
tail(NMDSColorCustomization) #Confirm removal
NMDSColorCustomization$sampleIDs #Confirm all sample IDs are there
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(Site),] #Reorder so sites are sorted alphabetically
NMDSColorCustomization <- NMDSColorCustomization[order(site),] #Reorder so sites are sorted alphabetically
NMDSColorCustomization <- NMDSColorCustomization[order(site),] #Reorder so sites are sorted alphabetically
head(NMDSColorCustomization) #Confirm sorting
NMDSColorCustomization
temporaryData <- data.frame(sample = sampleIDs,
y = rep(x = 0, times = length(sampleIDs))) #Create a temporary dataframe with sample IDs used in NMDS
head(temporaryData) #Confirm dataframe creation
NMDSColorCustomization <- merge(x = temporaryData, y = biologicalReplicates, by = "sampleIDs") #Merge biological information with samples used
head(NMDSColorCustomization) #Confirm merge
temporaryData <- data.frame(sampleIDs = sampleIDs,
y = rep(x = 0, times = length(sampleIDs))) #Create a temporary dataframe with sample IDs used in NMDS
head(temporaryData) #Confirm dataframe creation
NMDSColorCustomization <- merge(x = temporaryData, y = biologicalReplicates, by = "sampleIDs") #Merge biological information with samples used
head(NMDSColorCustomization) #Confirm merge
tail(NMDSColorCustomization) #Confirm merge
NMDSColorCustomization <- NMDSColorCustomization[, -2] #Remove empty column
tail(NMDSColorCustomization) #Confirm removal
NMDSColorCustomization$sampleIDs #Confirm all sample IDs are there
colnames(NMDSColorCustomization) <- c("sample", "site", "eelgrassCondition") #Rename first sample column
head(NMDSColorCustomization) #Confirm changes
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(site),] #Reorder so sites are sorted alphabetically
head(NMDSColorCustomization) #Confirm sorting
detach(NMDSColorCustomization)
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorCustomization$site == "FB")),
rep(x = "magenta", times = sum(NMDSColorCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorCustomization$site == "SK")),
rep(x = "black", times = sum(NMDSColorCustomization$site == "WB"))) #Create a color vector
NMDSColorCustomization[,3] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorCustomization) #Confirm addition
colnames(NMDSColorCustomization) <- c("Sample.Number", "Site", "Color") #Change column names
head(NMDSColorCustomization) #Confirm change
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorCustomization$Color, pch = 16)
NMDSColorCustomization
temporaryData <- data.frame(sampleIDs = sampleIDs,
y = rep(x = 0, times = length(sampleIDs))) #Create a temporary dataframe with sample IDs used in NMDS
head(temporaryData) #Confirm dataframe creation
NMDSColorCustomization <- merge(x = temporaryData, y = biologicalReplicates, by = "sampleIDs") #Merge biological information with samples used
head(NMDSColorCustomization) #Confirm merge
tail(NMDSColorCustomization) #Confirm merge
NMDSColorCustomization <- NMDSColorCustomization[, -2] #Remove empty column
tail(NMDSColorCustomization) #Confirm removal
NMDSColorCustomization$sampleIDs #Confirm all sample IDs are there
colnames(NMDSColorCustomization) <- c("sample", "site", "eelgrassCondition") #Rename first sample column
head(NMDSColorCustomization) #Confirm changes
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(site),] #Reorder so sites are sorted alphabetically
head(NMDSColorCustomization) #Confirm sorting
detach(NMDSColorCustomization)
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorCustomization$site == "FB")),
rep(x = "magenta", times = sum(NMDSColorCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorCustomization$site == "SK")),
rep(x = "black", times = sum(NMDSColorCustomization$site == "WB"))) #Create a color vector
NMDSColorCustomization[,3] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorCustomization) #Confirm addition
NMDSColorCustomization <- NMDSColorCustomization[order(sample),] #Reorder so samples are sorted alphabetically
NMDSColorCustomization <- NMDSColorCustomization[order(sample),] #Reorder so samples are sorted alphabetically
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(sample),] #Reorder so samples are sorted alphabetically
detach(NMDSColorCustomization)
head(NMDSColorCustomization) #Confirm sorting
detach(NMDSColorCustomization)
colnames(NMDSColorCustomization) <- c("Sample.Number", "Site", "Color") #Change column names
head(NMDSColorCustomization) #Confirm change
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorCustomization$Color, pch = 16)
legend("topright", cex = .5, pch = c(rep(x = 16, times = 5)), legend=c('Case Inlet', "Fidalgo Bay", "Willapa Bay", "Skokomish", "Port Gamble"), col=c('red', 'blue', 'black', 'green', 'magenta'))
title("Protein Expression Similarities between Sites and Habitats")
getwd() #Confirm changes
SRMAveragedAreasPivoted <- read.csv("2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-10-30-Protein-Areas-for-Boxplots.csv", header = TRUE) #Import modified dataset
head(SRMAveragedAreasPivoted) #Confirm import.
rownames(SRMAveragedAreasPivoted) <- SRMAveragedAreasPivoted[,1] #Set first column as rownames
SRMAveragedAreasPivoted <- SRMAveragedAreasPivoted[,-1] #Remove first column
head(SRMAveragedAreasPivoted) #Confirm changes
SRMAveragedAreasPivotedCorrected <- SRMAveragedAreasPivoted #Duplicate dataframe
SRMAveragedAreasPivotedCorrected[is.na(SRMAveragedAreasPivotedCorrected)] <- 0 #Replace NAs with 0s
head(SRMAveragedAreasPivotedCorrected) #Confirm there are no NAs
source("biostats.R") #Either load the source R script or copy paste. Must run this code before NMDS.
library(vegan)
area.protID <- SRMAveragedAreasPivotedCorrected #Save all area data as a new dataframe
head(area.protID) #Confirm change
area.t <- t(area.protID) #Transpose the file so that rows and columns are switched
head(area.t) #Confirm transposition
area.tra <- (area.t+1) #Add 1 to all values before transforming
area.tra <- data.trans(area.tra, method = 'log', plot = FALSE) #log(x+1) transformation
proc.nmds.norm.averaged.euclidean <- metaMDS(area.t, distance = 'euclidean', k = 2, trymax = 10000, autotransform = FALSE) #Make MDS dissimilarity matrix using euclidean distance. Julian confirmed that I should use euclidean distances, and not bray-curtis
#stressplot(proc.nmds.norm.averaged.euclidean) #Make Shepard plot
#vec.proc.nmds.norm.averaged.euclidean <- envfit(proc.nmds.norm.averaged.euclidean$points, area.t, perm = 1000) #Calculate loadings
ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "points", display = "sites") #Plot basic NMDS
#plot(vec.proc.nmds.norm.averaged.euclidean, p.max=.01, col='blue') #Plot eigenvectors
sampleIDs <- c("O01", "O04", "O06", "O08", "O10", "O100", "O101", "O102", "O103", "O106", "O118", "O121", "O122", "O124", "O128", "O131", "O137", "O14", "O140", "O145", "O147", "O17", "O21", "O22", "O24", "O26", "O30", "O31", "O32", "O35", "O40", "O43", "O46", "O49", "O51", "O52", "O56", "O60", "O64", "O66", "O71", "O78", "O90", "O91", "O96", "O99") #Create a sample ID vector
biologicalReplicates <- read.csv("2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-10-25-Biological-Replicate-Information-SampleID-Only.csv", header = TRUE) #Import biological replicate information
head(biologicalReplicates) #Confirm import
temporaryData <- data.frame(sampleIDs = sampleIDs,
y = rep(x = 0, times = length(sampleIDs))) #Create a temporary dataframe with sample IDs used in NMDS
head(temporaryData) #Confirm dataframe creation
NMDSColorShapeCustomization <- merge(x = temporaryData, y = biologicalReplicates, by = "sampleIDs") #Merge biological information with samples used
head(NMDSColorShapeCustomization) #Confirm merge
tail(NMDSColorShapeCustomization) #Confirm merge
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[, -2] #Remove empty column
tail(NMDSColorShapeCustomization) #Confirm removal
NMDSColorShapeCustomization$sampleIDs #Confirm all sample IDs are there
colnames(NMDSColorCustomization) <- c("sample", "site", "eelgrassCondition") #Rename first sample column
head(NMDSColorCustomization) #Confirm changes
colnames(NMDSColorShapeCustomization) <- c("sample", "site", "eelgrassCondition") #Rename first sample column
head(NMDSColorShapeCustomization) #Confirm changes
attach(NMDSColorShapeCustomization)
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[order(site),] #Reorder so sites are sorted alphabetically
head(NMDSColorShapeCustomization) #Confirm sorting
detach(NMDSColorShapeCustomization)
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorShapeCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorShapeCustomization$site == "FB")),
rep(x = "black", times = sum(NMDSColorShapeCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorShapeCustomization$site == "SK")),
rep(x = "magenta", times = sum(NMDSColorShapeCustomization$site == "WB"))) #Create a color vector
NMDSColorShapeCustomization[,4] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorShapeCustomization) #Confirm addition
attach(NMDSColorShapeCustomization)
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[order(eelgrassCondition),] #Reorder so eelgrass condition is sorted alphabetically
head(NMDSColorShapeCustomization) #Confirm sorting
detach(NMDSColorShapeCustomization)
NMDS.Shapes <- c(rep(x = 16, times = sum(NMDSColorShapeCustomization$eelgrassCondition == "Bare")),
rep(x = 17, times = sum(NMDSColorShapeCustomization$eelgrassCondition == "Eelgrass"))) #Make a shape vector
NMDSColorShapeCustomization[,5] <- NMDS.Shapes #Add the shape vector to the dataframe
head(NMDSColorShapeCustomization) #Confirm addition
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(sample),] #Reorder so samples are sorted alphabetically
head(NMDSColorShapeCustomization) #Confirm addition
attach(NMDSColorCustomization)
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[order(sample),] #Reorder so samples are sorted alphabetically
head(NMDSColorShapeCustomization) #Confirm sorting
detach(NMDSColorShapeCustomization)
colnames(NMDSColorShapeCustomization) <- c("Sample.Number", "Site", "Eelgrass.Condition", "Color", "Shape") #Change column names
head(NMDSColorShapeCustomization) #Confirm change
NMDSColorShapeCustomization
attach(NMDSColorShapeCustomization)
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[order(site),] #Reorder so sites are sorted alphabetically
head(NMDSColorShapeCustomization) #Confirm sorting
detach(NMDSColorShapeCustomization)
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorShapeCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorShapeCustomization$site == "FB")),
rep(x = "magenta", times = sum(NMDSColorShapeCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorShapeCustomization$site == "SK")),
rep(x = "black", times = sum(NMDSColorShapeCustomization$site == "WB"))) #Create a color vector
NMDSColorShapeCustomization[,4] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorShapeCustomization) #Confirm addition
attach(NMDSColorShapeCustomization)
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[order(eelgrassCondition),] #Reorder so eelgrass condition is sorted alphabetically
head(NMDSColorShapeCustomization) #Confirm sorting
detach(NMDSColorShapeCustomization)
NMDS.Shapes <- c(rep(x = 16, times = sum(NMDSColorShapeCustomization$eelgrassCondition == "Bare")),
rep(x = 17, times = sum(NMDSColorShapeCustomization$eelgrassCondition == "Eelgrass"))) #Make a shape vector
NMDSColorShapeCustomization[,5] <- NMDS.Shapes #Add the shape vector to the dataframe
head(NMDSColorShapeCustomization) #Confirm addition
attach(NMDSColorCustomization)
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[order(sample),] #Reorder so samples are sorted alphabetically
head(NMDSColorShapeCustomization) #Confirm sorting
detach(NMDSColorShapeCustomization)
colnames(NMDSColorShapeCustomization) <- c("Sample.Number", "Site", "Eelgrass.Condition", "Color", "Shape") #Change column names
head(NMDSColorShapeCustomization) #Confirm change
attach(NMDSColorShapeCustomization)
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[order(site),] #Reorder so sites are sorted alphabetically
temporaryData <- data.frame(sampleIDs = sampleIDs,
y = rep(x = 0, times = length(sampleIDs))) #Create a temporary dataframe with sample IDs used in NMDS
head(temporaryData) #Confirm dataframe creation
NMDSColorShapeCustomization <- merge(x = temporaryData, y = biologicalReplicates, by = "sampleIDs") #Merge biological information with samples used
head(NMDSColorShapeCustomization) #Confirm merge
tail(NMDSColorShapeCustomization) #Confirm merge
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[, -2] #Remove empty column
tail(NMDSColorShapeCustomization) #Confirm removal
NMDSColorShapeCustomization$sampleIDs #Confirm all sample IDs are there
colnames(NMDSColorShapeCustomization) <- c("sample", "site", "eelgrassCondition") #Rename first sample column
head(NMDSColorShapeCustomization) #Confirm changes
attach(NMDSColorShapeCustomization)
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[order(site),] #Reorder so sites are sorted alphabetically
head(NMDSColorShapeCustomization) #Confirm sorting
detach(NMDSColorShapeCustomization)
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorShapeCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorShapeCustomization$site == "FB")),
rep(x = "magenta", times = sum(NMDSColorShapeCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorShapeCustomization$site == "SK")),
rep(x = "black", times = sum(NMDSColorShapeCustomization$site == "WB"))) #Create a color vector
NMDSColorShapeCustomization[,4] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorShapeCustomization) #Confirm addition
attach(NMDSColorShapeCustomization)
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[order(eelgrassCondition),] #Reorder so eelgrass condition is sorted alphabetically
head(NMDSColorShapeCustomization) #Confirm sorting
detach(NMDSColorShapeCustomization)
NMDS.Shapes <- c(rep(x = 16, times = sum(NMDSColorShapeCustomization$eelgrassCondition == "Bare")),
rep(x = 17, times = sum(NMDSColorShapeCustomization$eelgrassCondition == "Eelgrass"))) #Make a shape vector
NMDSColorShapeCustomization[,5] <- NMDS.Shapes #Add the shape vector to the dataframe
head(NMDSColorShapeCustomization) #Confirm addition
attach(NMDSColorCustomization)
attach(NMDSColorShapeCustomization)
NMDSColorShapeCustomization <- NMDSColorShapeCustomization[order(sample),] #Reorder so samples are sorted alphabetically
head(NMDSColorShapeCustomization) #Confirm sorting
detach(NMDSColorShapeCustomization)
colnames(NMDSColorShapeCustomization) <- c("Sample.Number", "Site", "Eelgrass.Condition", "Color", "Shape") #Change column names
head(NMDSColorShapeCustomization) #Confirm change
NMDSColorShapeCustomization
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorShapeCustomization$Color, pch = NMDSColorShapeCustomization$Shape)
legend("topright", cex = .5, pch = c(rep(x = 16, times = 6), 17), legend=c('Case Inlet', "Fidalgo Bay", "Willapa Bay", "Skokomish", "Port Gamble", "Bare", "Eelgrass"), col=c('red', 'blue', 'black', 'green', 'magenta', 'black', 'black'))
title("Protein Expression Similarities between Sites and Habitats")
dissimArea.t <- vegdist(area.t, "euclidean") #Calculate dissimilarity matrix
ANOSIMReplicates <- biologicalReplicates #Duplicate dataframe
row.names(ANOSIMReplicates) <- ANOSIMReplicates[,1] #Assign sample numbers as row names
ANOSIMReplicates <- ANOSIMReplicates[,-1] #Remove Sample.Number column
head(ANOSIMReplicates) #Confirm changes
ANOSIMReplicates$eelgrassCondition <- factor(ANOSIMReplicates$eelgrassCondition) #Make sure residual factors are no longer present
ANOSIMReplicates$site <- factor(ANOSIMReplicates$site) #Make sure residual factors are no longer present
str(ANOSIMReplicates) #Confirm new factors
ANOSIMReplicates$siteEelgrass <- paste(ANOSIMReplicates$site, ANOSIMReplicates$eelgrassCondition) #Create third column for two-way ANOSIM
head(ANOSIMReplicates) #Confirm changes
siteNormANOSIM <- anosim(dat = dissimArea.t, grouping = ANOSIMReplicates[,1]) #One-way ANOSIM by Site presence
summary(siteNormANOSIM)
plot(siteNormANOSIM)
eelgrassNormANOSIM <- anosim(dat = dissimArea.t, grouping = ANOSIMReplicates[,2]) #One-way ANOSIM by Eelgrass presence
summary(eelgrassNormANOSIM)
plot(eelgrassNormANOSIM)
siteEelgrassANOSIM <- anosim(dat = dissimArea.t, grouping = ANOSIMReplicates[,3]) #Two-way ANOSIM by eelgrass and site
summary(siteEelgrassANOSIM)
plot(siteEelgrassANOSIM)
jpeg(filename = "2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-11-01-NMDS-Norm-Analysis-Averaged.jpeg", width = 1000, height = 1000)
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorShapeCustomization$Color, pch = NMDSColorShapeCustomization$Shape)
legend("topright", cex = .5, pch = c(rep(x = 16, times = 6), 17), legend=c('Case Inlet', "Fidalgo Bay", "Willapa Bay", "Skokomish", "Port Gamble", "Bare", "Eelgrass"), col=c('red', 'blue', 'black', 'green', 'magenta', 'black', 'black'))
title("Protein Expression Similarities between Sites and Habitats")
dev.off()
getwd() #Confirm changes
SRMAveragedAreasPivoted <- read.csv("2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-10-30-Protein-Areas-for-Boxplots.csv", header = TRUE) #Import modified dataset
head(SRMAveragedAreasPivoted) #Confirm import.
rownames(SRMAveragedAreasPivoted) <- SRMAveragedAreasPivoted[,1] #Set first column as rownames
SRMAveragedAreasPivoted <- SRMAveragedAreasPivoted[,-1] #Remove first column
head(SRMAveragedAreasPivoted) #Confirm changes
SRMAveragedAreasPivotedCorrected <- SRMAveragedAreasPivoted #Duplicate dataframe
SRMAveragedAreasPivotedCorrected[is.na(SRMAveragedAreasPivotedCorrected)] <- 0 #Replace NAs with 0s
head(SRMAveragedAreasPivotedCorrected) #Confirm there are no NAs
source("biostats.R") #Either load the source R script or copy paste. Must run this code before NMDS.
area.protID <- SRMAveragedAreasPivotedCorrected #Save all area data as a new dataframe
head(area.protID) #Confirm change
area.t <- t(area.protID) #Transpose the file so that rows and columns are switched
head(area.t) #Confirm transposition
area.tra <- (area.t+1) #Add 1 to all values before transforming
area.tra <- data.trans(area.tra, method = 'log', plot = FALSE) #log(x+1) transformation
proc.nmds.norm.averaged.euclidean <- metaMDS(area.t, distance = 'euclidean', k = 2, trymax = 10000, autotransform = FALSE) #Make MDS dissimilarity matrix using euclidean distance. Julian confirmed that I should use euclidean distances, and not bray-curtis
#stressplot(proc.nmds.norm.averaged.euclidean) #Make Shepard plot
#vec.proc.nmds.norm.averaged.euclidean <- envfit(proc.nmds.norm.averaged.euclidean$points, area.t, perm = 1000) #Calculate loadings
ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "points", display = "sites") #Plot basic NMDS
#plot(vec.proc.nmds.norm.averaged.euclidean, p.max=.01, col='blue') #Plot eigenvectors
sampleIDs <- c("O01", "O04", "O06", "O08", "O10", "O100", "O101", "O102", "O103", "O106", "O118", "O121", "O122", "O124", "O128", "O131", "O137", "O14", "O140", "O145", "O147", "O17", "O21", "O22", "O24", "O26", "O30", "O31", "O32", "O35", "O40", "O43", "O46", "O49", "O51", "O52", "O56", "O60", "O64", "O66", "O71", "O78", "O90", "O91", "O96", "O99") #Create a sample ID vector
biologicalReplicates <- read.csv("2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-10-25-Biological-Replicate-Information-SampleID-Only.csv", header = TRUE) #Import biological replicate information
head(biologicalReplicates) #Confirm import
#Create a dataframe with biological replicate information for samples used in NMDS
temporaryData <- data.frame(sampleIDs = sampleIDs,
y = rep(x = 0, times = length(sampleIDs))) #Create a temporary dataframe with sample IDs used in NMDS
head(temporaryData) #Confirm dataframe creation
NMDSColorCustomization <- merge(x = temporaryData, y = biologicalReplicates, by = "sampleIDs") #Merge biological information with samples used
head(NMDSColorCustomization) #Confirm merge
tail(NMDSColorCustomization) #Confirm merge
NMDSColorCustomization <- NMDSColorCustomization[, -2] #Remove empty column
tail(NMDSColorCustomization) #Confirm removal
NMDSColorCustomization$sampleIDs #Confirm all sample IDs are there
colnames(NMDSColorCustomization) <- c("sample", "site", "eelgrassCondition") #Rename first sample column
head(NMDSColorCustomization) #Confirm changes
ttach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(site),] #Reorder so sites are sorted alphabetically
head(NMDSColorCustomization) #Confirm sorting
detach(NMDSColorCustomization)
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorCustomization$site == "FB")),
rep(x = "magenta", times = sum(NMDSColorCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorCustomization$site == "SK")),
rep(x = "black", times = sum(NMDSColorCustomization$site == "WB"))) #Create a color vector
NMDSColorCustomization[,3] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorCustomization) #Confirm addition
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(sample),] #Reorder so samples are sorted alphabetically
head(NMDSColorCustomization) #Confirm sorting
detach(NMDSColorCustomization)
colnames(NMDSColorCustomization) <- c("Sample.Number", "Site", "Color") #Change column names
head(NMDSColorCustomization) #Confirm change
NMDSColorCustomization <- merge(x = temporaryData, y = biologicalReplicates, by = "sampleIDs") #Merge biological information with samples used
head(NMDSColorCustomization) #Confirm merge
tail(NMDSColorCustomization) #Confirm merge
NMDSColorCustomization <- NMDSColorCustomization[, -2] #Remove empty column
tail(NMDSColorCustomization) #Confirm removal
NMDSColorCustomization$sampleIDs #Confirm all sample IDs are there
colnames(NMDSColorCustomization) <- c("sample", "site", "eelgrassCondition") #Rename first sample column
head(NMDSColorCustomization) #Confirm changes
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(site),] #Reorder so sites are sorted alphabetically
head(NMDSColorCustomization) #Confirm sorting
detach(NMDSColorCustomization)
NMDS.Colors <- c(rep(x = "red", times = sum(NMDSColorCustomization$site == "CI")),
rep(x = "blue", times = sum(NMDSColorCustomization$site == "FB")),
rep(x = "magenta", times = sum(NMDSColorCustomization$site == "PG")),
rep(x = "green", times = sum(NMDSColorCustomization$site == "SK")),
rep(x = "black", times = sum(NMDSColorCustomization$site == "WB"))) #Create a color vector
NMDSColorCustomization[,3] <- NMDS.Colors #Add the color vector to the dataframe
head(NMDSColorCustomization) #Confirm addition
attach(NMDSColorCustomization)
NMDSColorCustomization <- NMDSColorCustomization[order(sample),] #Reorder so samples are sorted alphabetically
head(NMDSColorCustomization) #Confirm sorting
detach(NMDSColorCustomization)
colnames(NMDSColorCustomization) <- c("Sample.Number", "Site", "Color") #Change column names
head(NMDSColorCustomization) #Confirm change
NMDSColorCustomization
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorCustomization$Color, pch = 16)
legend("topright", cex = .5, pch = c(rep(x = 16, times = 5)), legend=c('Case Inlet', "Fidalgo Bay", "Willapa Bay", "Skokomish", "Port Gamble"), col=c('red', 'blue', 'black', 'green', 'magenta'))
title("Protein Expression Similarities between Sites and Habitats")
dissimArea.t <- vegdist(area.t, "euclidean") #Calculate dissimilarity matrix
jpeg(filename = "2017-10-10-Troubleshooting/2017-10-24-Coefficient-of-Variation/2017-11-01-NMDS-Norm-Analysis-Averaged-Pooled.jpeg", width = 1000, height = 1000)
fig.nmds <- ordiplot(proc.nmds.norm.averaged.euclidean, choices = c(1,2), type = "none", display = "sites", xlab= "Axis 1", ylab= "Axis 2", cex = 0.5) #Save NMDS as a new object
points(fig.nmds, "sites", col = NMDSColorCustomization$Color, pch = 16)
legend("topright", cex = .5, pch = c(rep(x = 16, times = 5)), legend=c('Case Inlet', "Fidalgo Bay", "Willapa Bay", "Skokomish", "Port Gamble"), col=c('red', 'blue', 'black', 'green', 'magenta'))
title("Protein Expression Similarities between Sites and Habitats")
dev.off()
dissimArea.t <- vegdist(area.t, "euclidean") #Calculate dissimilarity matrix
ANOSIMReplicates <- biologicalReplicates #Duplicate dataframe
row.names(ANOSIMReplicates) <- ANOSIMReplicates[,1] #Assign sample numbers as row names
ANOSIMReplicates <- ANOSIMReplicates[,-1] #Remove Sample.Number column
head(ANOSIMReplicates) #Confirm changes
ANOSIMReplicates$eelgrassCondition <- factor(ANOSIMReplicates$eelgrassCondition) #Make sure residual factors are no longer present
ANOSIMReplicates$site <- factor(ANOSIMReplicates$site) #Make sure residual factors are no longer present
str(ANOSIMReplicates) #Confirm new factors
ANOSIMReplicates$siteEelgrass <- paste(ANOSIMReplicates$site, ANOSIMReplicates$eelgrassCondition) #Create third column for two-way ANOSIM
head(ANOSIMReplicates) #Confirm changes
dissimArea.t <- vegdist(area.t, "euclidean") #Calculate dissimilarity matrix
ANOSIMReplicates <- biologicalReplicates #Duplicate dataframe
row.names(ANOSIMReplicates) <- ANOSIMReplicates[,1] #Assign sample numbers as row names
ANOSIMReplicates <- ANOSIMReplicates[,-1] #Remove Sample.Number column
head(ANOSIMReplicates) #Confirm changes
ANOSIMReplicates$site <- factor(ANOSIMReplicates$site) #Make sure residual factors are no longer present
str(ANOSIMReplicates) #Confirm new factors
siteNormANOSIM <- anosim(dat = dissimArea.t, grouping = ANOSIMReplicates[,1]) #One-way ANOSIM by Site presence
summary(siteNormANOSIM)
